function checkGoal() {
    let message = '';
    let isSaved = false;

    goalkeepers.forEach(keeper => {
        const closestX = Math.max(keeper.x, Math.min(ball.x, keeper.x + keeper.width));
        const closestY = Math.max(keeper.y, Math.min(ball.y, keeper.y + keeper.height));
        const distanceX = ball.x - closestX;
        const distanceY = ball.y - closestY;
        const distanceSquared = (distanceX * distanceX) + (distanceY * distanceY);
        if (distanceSquared < (ball.radius * ball.radius)) {
            isSaved = true;
        }
    });

    if (isSaved) {
        gameState = 'gameOver'; // 게임오버 상태
        message = 'NO GOAL!';
        messageBox.style.color = '#ff4757';
        messageBox.innerHTML = `GAME OVER<div id="retry-message">FINAL SCORE: ${score}<br>RETRY? (Enter)</div>`;
    } else if (ball.x > goal.x && ball.x < goal.x + goal.width &&
               ball.y > goal.y && ball.y < goal.y + goal.height) {
        gameState = 'nextStage'; // ✨ 다음 스테이지 전환 상태
        message = 'GOAL!';
        messageBox.style.color = 'gold';
        messageBox.innerHTML = `${message}<div id="retry-message">NEXT STAGE!</div>`;
        score += 100;
        stage += 1;
        setTimeout(setupStage, 2000);
    } else {
        gameState = 'result'; // MISS일 때의 결과 상태
        message = 'MISS';
        messageBox.style.color = 'white';
        messageBox.innerHTML = `${message}<div id="retry-message">RETRY? (Enter)</div>`;
    }

    messageBox.style.display = 'block';
}
